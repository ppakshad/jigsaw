Using TensorFlow backend.
WARNING:root:Running with configuration:
{'backdoor': False,
 'benign_poison_ratio': 0.005,
 'classifier': 'SVM',
 'dataset': 'apg',
 'debug': True,
 'device': '5',
 'donor_depth': 10,
 'evasion': False,
 'harvest': False,
 'limited_data': 1.0,
 'middle_N_benign': None,
 'mlp_batch_size': 32,
 'mlp_dropout': 0.2,
 'mlp_epochs': 50,
 'mlp_hidden': None,
 'mlp_lr': 0.001,
 'mlp_retrain': None,
 'mntd_half_training': 0,
 'mode': None,
 'n_features': 10000,
 'organ_depth': 100,
 'poison_mal_benign_rate': 0,
 'preload': False,
 'random_state': 42,
 'rerun_past_failures': False,
 'run_tag': 'CLASSIFIER',
 'secsvm_batchsize': 256,
 'secsvm_k': 0.25,
 'secsvm_lr': 0.0009,
 'secsvm_nepochs': 10,
 'seed_model': None,
 'select_benign_features': None,
 'serial': False,
 'space': 'feature_space',
 'subset_family': None,
 'svm_c': 1,
 'svm_iter': 10000,
 'test_ratio': 0.33,
 'trojan_size': 5,
 'trojans': None,
 'use_all_triggers': False}
DEBUG: 02-27 18:26:15: backdoor_general.py:121 * 140540911896384 Fetching model...
DEBUG: 02-27 18:26:15: models.py:242 * 140540911896384 Loading model from models/apg/SVM/svm-f10000.p...
INFO: 02-27 18:26:17: backdoor_general.py:168 * 140540911896384 Using classifier:
SVM
INFO: 02-27 18:26:17: backdoor_general.py:169 * 140540911896384 X_train: (100187, 10000), X_test: (49347, 10000)
INFO: 02-27 18:26:17: backdoor_general.py:170 * 140540911896384 y_train: (100187,), y_test: (49347,)
INFO: 02-27 18:26:17: backdoor_general.py:171 * 140540911896384 y_train counter: Counter({0: 90288, 1: 9899})
INFO: 02-27 18:26:17: backdoor_general.py:172 * 140540911896384 y_test counter: Counter({0: 44471, 1: 4876})
INFO: 02-27 18:26:18: backdoor_general.py:177 * 140540911896384 X_train_mal: (9899, 10000)
CRITICAL: 02-27 18:26:25: backdoor_general.py:179 * 140540911896384 X_train_mal after np.unique: (7427, 10000)
CRITICAL: 02-27 18:26:25: backdoor_general.py:228 * 140540911896384 models/apg/SVM/SVM_full_feature_weights_c1_iter10000_nfea10000.csv already exists, no overwrite
CRITICAL: 02-27 18:26:25: backdoor_general.py:228 * 140540911896384 models/apg/SVM/SVM_benign_feature_weights_c1_iter10000_nfea10000.csv already exists, no overwrite
CRITICAL: 02-27 18:26:25: backdoor_general.py:228 * 140540911896384 models/apg/SVM/SVM_malicious_feature_weights_c1_iter10000_nfea10000.csv already exists, no overwrite
INFO: 02-27 18:26:25: myutil.py:158 * 140540911896384 Dumping data to models/apg/SVM/all_feature_names_10000.json...
INFO: 02-27 18:26:25: backdoor_general.py:200 * 140540911896384 Original classifier: 
INFO: 02-27 18:26:27: myutil.py:292 * 140540911896384 ROC curve saved
DEBUG: 02-27 18:26:27: myutil.py:184 * 140540911896384 cm: [[90125   163]
 [  241  9658]]
DEBUG: 02-27 18:26:27: myutil.py:184 * 140540911896384 cm: [[44147   324]
 [  448  4428]]
INFO: 02-27 18:26:27: myutil.py:268 * 140540911896384 Performance on training:
{'model_performance': {'acc': 0.995967540698893,
                       'cm': array([[90125,   163],
       [  241,  9658]]),
                       'f1': 0.9795131845841785,
                       'fpr': 0.0018053340421761474,
                       'precision': 0.9834029121270746,
                       'recall': 0.9756541064754015}}
INFO: 02-27 18:26:27: myutil.py:269 * 140540911896384 Performance on testing:
{'model_performance': {'acc': 0.9843556852493566,
                       'cm': array([[44147,   324],
       [  448,  4428]]),
                       'f1': 0.919817199833818,
                       'fpr': 0.007285646826021452,
                       'precision': 0.9318181818181818,
                       'recall': 0.9081214109926169},
 'number_of_apps': {'test': 49347, 'tps': 4428, 'train': 100187}}
INFO: 02-27 18:26:27: backdoor_general.py:263 * 140540911896384 time elapsed: 11.7 seconds
